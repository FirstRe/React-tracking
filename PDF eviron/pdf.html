<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script src="js/jsPDF-CustomFonts-support-master/dist/jspdf.customfonts.min.js"></script>
    <script src="js/jsPDF-CustomFonts-support-master/dist/default_vfs.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
    <script src="node_modules/pdfmake/build/pdfmake.min.js"></script>
    <script src="node_modules/pdfmake/build/vfs_fonts.js"></script>
    <script src="ThaiBath-master/thaibath.js" type="text/javascript" charset="utf-8"></script>

    <title>ใบเสนอราคา</title>
</head>

<body style=" font-family: 'Kanit', sans-serif; background-color: #ffffff; color: #000000;">
  <div class="container p-5 "> 
  <div class="">
    
      
      <div class="container input-center">
      <span>
       <h1>สินค้า</h1>
        <h4 class="mt-4">กรุณาเลือกสินค้า</h4>
        <div class="mt-5">
          <h2>กล้อง ไทม์แลปส์</h2>
          <div class="product-flex" id="timelapse ">
             
              <div class=" products">
                <!-- <h3>BCC100</h3> -->
                  <div class="">
                        <img src="img/BCC100.png" alt="" style="width: 100%; max-width:350px;padding: 20px; display: block; margin: auto;">
                       
                        <input type="button" value="-" class="minus bcc100_minus  " id="min">
                        <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                        <input type="button" value="+" class="plus bcc100_plus" >   
                  </div>
                  <div class="mt-2">
                      
                    <p><input type="checkbox" id="bcc100" style="margin: 10px;"> เลือกสินค้า</p>
                   </div>
              </div>
                          
              <div class=" products">
                <!-- <h3>BCC200</h3> -->
                     <div class="">
                        <img src="img/BCC200.png" alt="" style="width: 100%; max-width:350px;padding: 20px; display: block; margin: auto;">
                        
                        <input type="button" value="-" class="minus bcc200_minus " id="min">
                        <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                        <input type="button" value="+" class="plus bcc200_plus" >   
                     </div>
                     <div class="mt-2">
                      
                      <p><input type="checkbox" id="bcc200" style="margin: 10px;"> เลือกสินค้า</p>
                     </div>
                   
              </div>

              <div class=" products">
                <!-- <h3>BCC2000</h3> -->
                        <img src="img/bcc2000new.png" alt="" style="width: 100%; max-width:220px;padding: 20px; display: block; margin: auto;">
                       
                        <input type="button" value="-" class="minus bcc2000_minus " id="min">
                        <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                        <input type="button" value="+" class="plus bcc2000_plus" >  
                        <div class="mt-2">
                      
                          <p><input type="checkbox" id="bcc2000" style="margin: 10px;"> เลือกสินค้า</p>
                         </div>
                        
              </div>
              
          </div>
          <div style="padding: 40px;padding-bottom: 0px;">
             <h2>กล้องตาแมว อัจฉริยะ</h2>
          </div>
          
          <div class="product-flex">
              <div class=" products">
                  <!-- <h3>SHC500</h3> -->
                       <img src="img/SHC500.png" alt="" style="width: 100%; max-width:350px;padding: 20px; display: block; margin: auto;">
                       
                       <input type="button" value="-" class="minus SHC500_minus " id="min">
                       <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                       <input type="button" value="+" class="plus SHC500_plus" >  
                       <div class="mt-2">
                        <p><input type="checkbox" id="SHC500" style="margin: 10px;"> เลือกสินค้า</p>
                       </div> 
              </div>

              <div class=" products">
                  <!-- <h3>SHC1000</h3> -->
                       <img src="img/SHC1000.png" alt="" style="width: 100%; max-width:350px;padding: 20px; display: block; margin: auto;">
                       
                       <input type="button" value="-" class="minus SHC1000_minus " id="min">
                       <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                       <input type="button" value="+" class="plus SHC1000_plus" >  
                       <div class="mt-2">
                        <p><input type="checkbox" id="SHC1000" style="margin: 10px;"> เลือกสินค้า</p>
                       </div>  
              </div>

              <div class=" products">
                  <!-- <h3>SHC1000W</h3> -->
                      <img src="img/SHC1000Wd.png" alt="" style="width: 100%; max-width:350px;padding: 20px; display: block; margin: auto;">
                      
                      <input type="button" value="-" class="minus SHC1000W_minus" id="min">
                      <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                      <input type="button" value="+" class="plus SHC1000W_plus" >  
                      <div class="mt-2">
                        <p><input type="checkbox" id="SHC1000W" style="margin: 10px;"> เลือกสินค้า</p>
                       </div> 
              </div>
            </div>
            <div style="padding: 40px;padding-bottom: 0px;">
              <h2>สินค้าอื่นๆ</h2>
           </div>
          <div class="product-flex" >
                    <div class=" products">
                         <!-- <h3>AFB1000</> -->
                                  <img src="img/AFB1000-03.jpg" alt="" style="width: 100%; max-width:200px;padding: 20px; display: block; margin: auto;">
                                  
                                  <input type="button" value="-" class="minus AFB1000_minus " id="min">
                                  <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                                  <input type="button" value="+" class="plus AFB1000_plus" > 
                                  <div class="mt-2">
                                    <p><input type="checkbox" id="AFB1000" style="margin: 10px;"> เลือกสินค้า</p>
                                   </div>   
                    </div>

                    <div class=" products">
                         <!-- <h3>cloudmed</h3> -->
                                  <img src="img/Icare.png" alt="" style="width: 100%; max-width:350px;padding: 20px; display: block; margin: auto;">
                                  
                                  <input type="button" value="-" class="minus cloudmed_minus " id="min">
                                  <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                                  <input type="button" value="+" class="plus cloudmed_plus" >   
                                  <div class="mt-2">
                                    <p><input type="checkbox" id="cloudmed" style="margin: 10px;"> เลือกสินค้า</p>
                                   </div> 
                  </div>

                    <div class=" products">
                         <!-- <h3>BVR120</h3> -->
                                  <img src="img/Helmet.jpg" alt="" style="width: 100%; max-width:350px;padding: 20px; display: block; margin: auto; border-radius: 45px;">
                                  
                                  <input type="button" value="-" class="minus  BVR120_minus " id="min">
                                  <input name="qty" id="quantity" type="text" value="1" class="qty input-width">
                                  <input type="button" value="+" class="plus  BVR120_plus" >  
                                  <div class="mt-2">
                                    <p><input type="checkbox"  id="BVR120" style="margin: 10px;"> เลือกสินค้า</p>
                                   </div>  
                    </div>
          </div>
        
      </span>
    </div>
  </div>

<div class="form_index">
  <h2 class="mb-5">แบบฟอร์มใบเสนอราคา</h2>
 <div class="container ">
  <div class="mb-3 row">
    <label for="staticEmail" class="col-sm-3 col-form-label" style="text-align: right;">ชื่อลูกค้า(ภาษาอังกฤษ)</label>
    <div class="col-sm-9">
      <input type="text" class="form-control" id="name" value="">
    </div>
  </div>
  <div class="mb-3 row">
    <label for="staticEmail" class="col-sm-3 col-form-label" style="text-align: right;">สาขา</label>
    <div class="col-sm-9">
      <input type="text" class="form-control" id="tax" value="">
    </div>
  </div>
  <div class="mb-3 row">
    <label for="staticEmail" class="col-sm-3 col-form-label" style="text-align: right;">ที่อยู่</label>
    <div class="col-sm-9">
      <textarea rows="5" cols="50" id="adss" value="" class="form-control" style="width: 100%;max-width: 600px;"> 
       
      </textarea>
     
    </div>
  </div>
    
     <div class="mb-3 row">
      <label for="staticEmail" class="col-sm-3 col-form-label" style="text-align: right;">Company Tax Code:</label>
      <div class="col-sm-9">
        <input type="text" class="form-control" id="tax" value="">
      </div>
    </div>
    
    <div class="mb-3 row">
      <label for="staticEmail" class="col-sm-3 col-form-label" style="text-align: right;">เบอร์โทร</label>
      <div class="col-sm-9">
        <input type="text" class="form-control" id="phone" value="">
      </div>
    </div>

    <div class="mb-3 row">
      <label for="staticEmail" class="col-sm-3 col-form-label" style="text-align: right;">ATTN</label>
      <div class="col-sm-9">
        <input type="text" class="form-control" id="attn" value="">
      </div>
    </div>
     
    <div class="mb-3 row">
      <label for="staticEmail" class="col-sm-3 col-form-label" style="text-align: right;">Fax</label>
      <div class="col-sm-9">
        <input type="text" class="form-control" id="fax" value="">
      </div>
    </div>
    <div class="mb-3 row">
      <label for="staticEmail" class="col-sm-3 col-form-label" style="text-align: right;">E-mail</label>
      <div class="col-sm-9">
        <input type="text" class="form-control" id="email" value="">
      </div>
    </div>
     
     
     
    </div>
    <form action="">
      <div class="mb-3 row">
        <div class="col-sm-3">

        </div>
      <div class="col-sm-9"> <button style="width: 100%;" type="submit" class="btn btn-primary" id="cmd" onclick="makePDF()">สร้างใบเสนอราคา</button></div>
      </form>
</div>

</div>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
</body>












</html>


    
<script>
   var product_output=[]  //สินค้าในตาราง
   var counter=0
   var product_number =[] //ลำดับสินค้า
   const unit = ["","","","","","","","",""]
   const unit_price =["","","","","","","","",""]; 
   const unit_cal =[9470,14959,29700,3430,5530,8100,4050,3930,3600];
   const result =["","","","","","","","","",""] //ผลลัพธ์การคำนวณ
   var product_quantity=["","","","","","","","","","","","","",""]; //ลำดับจำนวนสินค้า
   var discount_text=[]
   var cal_num = 0;
   //bcc100,bcc200,bcc2000,ตาแมวshc500,ตาแมวshc1000,ตาแมวshc1000W,สายเคเบิล รุ่น AFB1000,cloudmed,wintouch
   var product_id
   //assigned default quantity
   reassign(product_quantity, [0], 1);
   reassign(product_quantity, [1], 1);
   reassign(product_quantity, [2], 1);
   reassign(product_quantity, [3], 1);
   reassign(product_quantity, [4], 1);
   reassign(product_quantity, [5], 1);
   reassign(product_quantity, [6], 1);
   reassign(product_quantity, [7], 1);
   reassign(product_quantity, [8], 1);


   //bcc100
   $('.bcc100_minus').click(function(){
   
    quantityField = $(this).next();
    if (quantityField.val() >= 1) {
      quantityField.val(parseInt(quantityField.val(), 10) - 1);
      let bcc100num = quantityField.val()
    reassign(product_quantity, [0], bcc100num);
    
    }
    
  });
  $('.bcc100_plus').click(function(){
   
    quantityField = $(this).prev();
    if (quantityField.val() >= 0) {
    quantityField.val(parseInt(quantityField.val(), 10) + 1);
    let bcc100num = quantityField.val()
    reassign(product_quantity, [0], bcc100num);
    }
  });
  //bcc200
  $('.bcc200_minus').click(function(){
   
    quantityField = $(this).next();
    if (quantityField.val() >= 1) {
      quantityField.val(parseInt(quantityField.val(), 10) - 1);
      let bcc200num = quantityField.val()
    reassign(product_quantity, [1], bcc200num);
    
    }
    
  });
  $('.bcc200_plus').click(function(){
   
    quantityField = $(this).prev();
    if (quantityField.val() >= 0) {
    quantityField.val(parseInt(quantityField.val(), 10) + 1);
    let bcc200num = quantityField.val()
    reassign(product_quantity, [1], bcc200num);
    }
  });
  //bcc2000
  $('.bcc2000_minus').click(function(){
   
   quantityField = $(this).next();
   if (quantityField.val() >= 1) {
     quantityField.val(parseInt(quantityField.val(), 10) - 1);
     let bcc2000num = quantityField.val()
   reassign(product_quantity, [2], bcc2000num);
   
   }
   
 });
 $('.bcc2000_plus').click(function(){
  
   quantityField = $(this).prev();
   if (quantityField.val() >= 0) {
   quantityField.val(parseInt(quantityField.val(), 10) + 1);
   let bcc2000num = quantityField.val()
   reassign(product_quantity, [2], bcc2000num);
   }
 });
  //SHC500
  $('.SHC500_minus').click(function(){
   
   quantityField = $(this).next();
   if (quantityField.val() >= 1) {
     quantityField.val(parseInt(quantityField.val(), 10) - 1);
     let SHC500num = quantityField.val()
   reassign(product_quantity, [3], SHC500num);
   
   }
   
 });
 $('.SHC500_plus').click(function(){
  
   quantityField = $(this).prev();
   if (quantityField.val() >= 0) {
   quantityField.val(parseInt(quantityField.val(), 10) + 1);
   let SHC500num = quantityField.val()
   reassign(product_quantity, [3], SHC500num);
   }
 });   
 //SHC1000
 $('.SHC1000_minus').click(function(){
   
   quantityField = $(this).next();
   if (quantityField.val() >= 1) {
     quantityField.val(parseInt(quantityField.val(), 10) - 1);
     let SHC1000num = quantityField.val()
   reassign(product_quantity, [4], SHC1000num);
   
   }
   
 });
 $('.SHC1000_plus').click(function(){
  
   quantityField = $(this).prev();
   if (quantityField.val() >= 0) {
   quantityField.val(parseInt(quantityField.val(), 10) + 1);
   let SHC1000num = quantityField.val()
   reassign(product_quantity, [4], SHC1000num);
   }
 });   
  //shc1000w
  $('.SHC1000W_minus').click(function(){
   
   quantityField = $(this).next();
   if (quantityField.val() >= 1) {
     quantityField.val(parseInt(quantityField.val(), 10) - 1);
     let SHC1000Wnum = quantityField.val()
   reassign(product_quantity, [5], SHC1000Wnum);
   
   }
   
 });
 $('.SHC1000W_plus').click(function(){
  
   quantityField = $(this).prev();
   if (quantityField.val() >= 0) {
   quantityField.val(parseInt(quantityField.val(), 10) + 1);
   let SHC1000Wnum = quantityField.val()
   reassign(product_quantity, [5], SHC1000Wnum);
   }
 });      
     
   //afb1000
   $('.AFB1000_minus').click(function(){
   
   quantityField = $(this).next();
   if (quantityField.val() >= 1) {
     quantityField.val(parseInt(quantityField.val(), 10) - 1);
     let AFB1000num = quantityField.val()
   reassign(product_quantity, [6], AFB1000num);
   
   }
   
 });
 $('.AFB1000_plus').click(function(){
  
   quantityField = $(this).prev();
   if (quantityField.val() >= 0) {
   quantityField.val(parseInt(quantityField.val(), 10) + 1);
   let AFB1000num = quantityField.val()
   reassign(product_quantity, [6], AFB1000num);
   }
 });     
 //cloudmed
 $('.cloudmed_minus').click(function(){
   
   quantityField = $(this).next();
   if (quantityField.val() >= 1) {
     quantityField.val(parseInt(quantityField.val(), 10) - 1);
     let cloudmednum = quantityField.val()
   reassign(product_quantity, [7], cloudmednum);
   
   }
   
 });
 $('.cloudmed_plus').click(function(){
  
   quantityField = $(this).prev();
   if (quantityField.val() >= 0) {
   quantityField.val(parseInt(quantityField.val(), 10) + 1);
   let cloudmednum = quantityField.val()
   reassign(product_quantity, [7], cloudmednum);
   }
 });   
 //bvr200
 $('.BVR120_minus').click(function(){
   
   quantityField = $(this).next();
   if (quantityField.val() >= 1) {
     quantityField.val(parseInt(quantityField.val(), 10) - 1);
     let BVR120num = quantityField.val()
   reassign(product_quantity, [8], BVR120num);
   
   }
   
 });
 $('.BVR120_plus').click(function(){
  
   quantityField = $(this).prev();
   if (quantityField.val() >= 0) {
   quantityField.val(parseInt(quantityField.val(), 10) + 1);
   let BVR120num = quantityField.val()
   reassign(product_quantity, [8], BVR120num);
   }
 });      
     
     
 const discount =[473.50,747.95,1485,171.50,276.50,405]
 var final_discount=[]
 let final_price =[]
     
   


    function makePDF() {
      const bcc100_check = document.getElementById("bcc100").checked ;
      const bcc200_check = document.getElementById("bcc200").checked;
      const bcc2000_check = document.getElementById("bcc2000").checked;
      const SHC500_check = document.getElementById("SHC500").checked;
      const SHC1000_check = document.getElementById("SHC1000").checked ;
      const SHC1000w_check = document.getElementById("SHC1000W").checked;
      const AFB1000check = document.getElementById("AFB1000").checked ;
      const cloudmed_check = document.getElementById("cloudmed").checked;
      const BVR120_check = document.getElementById("BVR120").checked ;
      var customer_code = document.getElementById("name").value
         let MyDate = new Date();
        let MyDateString;

        MyDate.setDate(MyDate.getDate());

        MyDateString = ('0' + MyDate.getDate()).slice(-2) + '.'
                    + ('0' + (MyDate.getMonth()+1)).slice(-2) + '.'
                    + MyDate.getFullYear();
       MyDateString2 = ('0' + MyDate.getDate()).slice(-2) + '-'
                    + (monthName((MyDate.getMonth()+1))) + '-'
                    + MyDate.getFullYear();

                    function monthName(mon) {
              return ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'][mon - 1];
            }

      var brand=["","",""]
      var cus_type=[""]
      var model=[]
      customer_code = customer_code.slice(0,3)
      if(bcc100_check==true)
      {
       counter=counter+1
       brand[0]="BR-"
       cus_type="CON"
        model.push("BCC100_")
       product_output.push("กล้อง Time-lapse รุ่น BCC100\n")
       discount_text.push("ส่วนลด BCC100 5%\n")
       reassign(unit_price, [0], "9,470");
       reassign(unit, [0], "กล่อง");
       cal_num = unit_cal[0]*product_quantity[0]
       
      let convert_num = toCommas(cal_num)
      let cal_discount=discount[0]*product_quantity[0]
       final_price.push(cal_num-cal_discount)
      let convert_num_discount = toCommas(cal_discount)
       result[9] = cal_discount
       result[0]=convert_num
      }
      else {
        reassign(product_quantity, [0], "");
        reassign(unit_price, [0], "");
        reassign(unit, [0], "");
      }
      
      if(bcc200_check==true)
      {
        brand[0]="BR-"
       cus_type="CON"
        model.push("BCC200_")
        counter=counter+1
       product_output.push("กล้อง Time-lapse รุ่น BCC200\n")
       discount_text.push("ส่วนลด BCC200 5%\n")
       reassign(unit_price, [1],"14,959");
        reassign(unit, [1], "กล่อง");
        cal_num = unit_cal[1]*product_quantity[1]
      let convert_num = toCommas(cal_num)
      let cal_discount=discount[1]*product_quantity[1]
      final_price.push(cal_num-cal_discount)
      let convert_num_discount = toCommas(cal_discount)
       result[10] = cal_discount
       result[1]=convert_num
       
      }
      else {
        reassign(product_quantity, [1], "");
        reassign(unit_price, [1], "");
       reassign(unit, [1], "");
      }
      if(bcc2000_check==true)
      {
        brand[0]="BR-"
       cus_type="CON"
        model.push("BCC2000_")
        counter=counter+1
       product_output.push("กล้อง Time-lapse รุ่น BCC2000\n")
       discount_text.push("ส่วนลด BCC2000 5%\n")
       reassign(unit_price, [2], "29,700");
       reassign(unit, [2], "กล่อง");
       cal_num = unit_cal[2]*product_quantity[2]
      let convert_num = toCommas(cal_num)
      let cal_discount=discount[2]*product_quantity[2]
      final_price.push(cal_num-cal_discount)
      let convert_num_discount = toCommas(cal_discount)
       result[11] = cal_discount
       result[2]=convert_num
      }
      else {
        reassign(product_quantity, [2], "");
        reassign(unit_price, [2], "");
       reassign(unit, [2], "");
      }
      
      if(SHC500_check==true)
      {
        brand[0]="BR-"
       cus_type="CON"
        model.push("SHC500_")
        counter=counter+1
       product_output.push("กล้องตาแมวดิจิตอล รุ่น SHC500\n")
       discount_text.push("ส่วนลด SHC500 5%\n")
       reassign(unit_price, [3], "3,430");
       reassign(unit, [3], "กล่อง");
       cal_num = unit_cal[3]*product_quantity[3]
      let convert_num = toCommas(cal_num)
      let cal_discount=discount[3]*product_quantity[3]
      final_price.push(cal_num-cal_discount)
      let convert_num_discount = toCommas(cal_discount)
       result[12] = cal_discount
       result[3]=convert_num
      }
      else {
        reassign(product_quantity, [3], "");
        reassign(unit_price, [3], "");
       reassign(unit, [3], "");
      }
      
      if(SHC1000_check==true)
      {
        brand[0]="BR-"
       cus_type="CON"
        model.push("SHC1000_")
        counter=counter+1
       product_output.push("กล้องตาแมวดิจิตอล รุ่น SHC1000\n")
       discount_text.push("ส่วนลด SHC1000 5%\n")
       reassign(unit_price, [4], "5,530");
       reassign(unit, [4], "กล่อง");
       cal_num = unit_cal[4]*product_quantity[4]
      let convert_num = toCommas(cal_num)
      let cal_discount=discount[4]*product_quantity[4]
      final_price.push(cal_num-cal_discount)
      let convert_num_discount = toCommas(cal_discount)
       result[13] = cal_discount
       result[4]=convert_num
      }
      else {
        reassign(product_quantity, [4], "");
        reassign(unit_price, [4], "");
       reassign(unit, [4], "");
      }
      
      if(SHC1000w_check==true)
      {
        brand[0]="BR-"
       cus_type="CON"
        model.push("SHC1000W_")
        counter=counter+1
       product_output.push("กล้องตาแมวดิจิตอล รุ่น SHC1000W\n")
       discount_text.push("ส่วนลด SHC1000W 5%\n")
       reassign(unit_price, [5], "8,100");
       reassign(unit, [5], "กล่อง");
       cal_num = unit_cal[5]*product_quantity[5]
      let convert_num = toCommas(cal_num)
      let cal_discount=discount[5]*product_quantity[5]
      final_price.push(cal_num-cal_discount)
      let convert_num_discount = toCommas(cal_discount)
       result[14] = cal_discount
       result[5]=convert_num
      }
      else {
        reassign(product_quantity, [5], "");
        reassign(unit_price, [5], "");
       reassign(unit, [5], "");
      }
      
      if(AFB1000check==true)
      {
        brand[0]="BR-"
       cus_type="CON"
        model.push("AFB1000_")
        counter=counter+1
       product_output.push("สายเคเบิล รุ่น AFB1000\n")
       reassign(unit_price, [6], "4050");
       reassign(unit, [6], "กล่อง");
       cal_num = unit_cal[6]*product_quantity[6]
       final_price.push(cal_num)
      let convert_num = toCommas(cal_num)
       result[6]=convert_num
      }
      else {
        reassign(product_quantity, [6], "");
        reassign(unit_price, [6], "");
       reassign(unit, [6], "");
      }
      
      if(cloudmed_check==true)
      {
        brand[1]="CM-"
       cus_type="AD"
        model.push("CLOUDMED_")
        counter=counter+1
       product_output.push("อุปกรณ์ตรวจสุขภาพหัวใจ Cloudmed iCARE\n")
       reassign(unit_price, [7], "3,930");
       reassign(unit, [7], "กล่อง");
       cal_num = unit_cal[7]*product_quantity[7]
       final_price.push(cal_num)
      let convert_num = toCommas(cal_num)
       result[7]=convert_num
      }
      else {
        reassign(product_quantity, [7], "");
        reassign(unit_price, [7], "");
       reassign(unit, [7], "");
      }
      
      if(BVR120_check==true)
      {
        brand[2]="WT-"
       cus_type="RD"
        model.push("BVR100_")

        counter=counter+1
       product_output.push("กล้องติดรถรุ่น BVR120\n")
       reassign(unit_price, [8], "3,600");
       reassign(unit, [8], "กล่อง");
       cal_num = unit_cal[8]*product_quantity[8]
       final_price.push(cal_num)
      let convert_num = toCommas(cal_num)
       result[8]=convert_num
      }
      else {
        reassign(product_quantity, [8], "");
        reassign(unit_price, [8], "");
       reassign(unit, [8], "")
      }
      
      var net_final_price=final_price.reduce(function(a, b){
        return a + b;
    }, 0);


      for(let i=1;i<=counter;i++){
         product_number.push(i+"\n")
      
      }
     for(let k=0;k<counter;k++)
     {
       let j = 9;
        if(isInteger(result[k])==true){
          result[k]=result[k]
          
        }
        if(isInteger(result[j])==true){
          result[j]=result[j]
          
        }
        if(isFloat(result[k])==true){
          result[k]=result[k].toFixed(2)
          
        }
        if(isFloat(result[j])==true){
          result[j]=result[j].toFixed(2)
          
        }
        
         j = j+1;
     }
      
     var  vat = (7*net_final_price)/100 
     vat = parseInt(vat);
     net_final_price = parseInt(net_final_price)
     if(isInteger(vat)==true)
     {
       vat = vat
     }
     else if(isFloat(vat)==true)
     {
       vat = vat.toFixed(2)
     }
     var  net_price = vat + net_final_price
     var cus_ref
      
     if(cus_type=="CON"){
        cus_ref = "Construction"

     }
     else if(cus_type=="RD")
     {
      cus_ref="Rider"
     }
     else if(cus_type=="AD")
     {
     cus_ref="Adult"
     }
     let x=model.join("")
    var model2=x.replaceAll("_","")


      var name = document.getElementById("name").value;
      var address = document.getElementById("adss").value;
      var tax = document.getElementById("tax").value;
      var phone = document.getElementById("phone").value;
      var attn = document.getElementById("attn").value;
      var fax = document.getElementById("fax").value;
      var email = document.getElementById("email").value;
  var thaibath = ArabicNumberToText(net_price);
      pdfMake.fonts = {
  THSarabunNew: {
    normal: 'THSarabunNew.ttf',
    bold: 'THSarabunNew Bold.ttf'
    
  }
}
var dd = {
  "content": [

  {
      
      "nodeName": "PAGE",
      "stack": [
        {
          "nodeName": "DIV",
          "stack": [
            {
              "nodeName": "DIV",
              "stack": [
                {
                  "nodeName": "DIV",
                  columns:[
                    {
                      
                     "stack": [
                    {
                      lineHeight: 0.25,
                      "text": "E.VIRON Co., Ltd",lineHeight:0.5,
                      bold:true,
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-6",
                        "left",
                        "fw-bolder"
                      ]
                    },
                    {
                      lineHeight: 0.25,
                      "text": "บริษทั อี.ไวรอน จำกัด",
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-6",
                        "left"
                      ]
                    },
                    {lineHeight: 0.25,
                      "text": "1/124 ซอยวชัรพล2/7 ",
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-6",
                        "left"
                      ]
                    },
                    {lineHeight: 0.25,
                      "text": "แขวงท่าแร้ง เขตบางเขน กรุงเทพฯ 10220",
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-6",
                        "left"
                      ]
                    },
                    {
                      "text": "โทร: +66 (0) 2102-9468",lineHeight:0.5,
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-6",
                        "left"
                      ]
                    },
                    {
                      text:'มือถือ: +66 (0) 98-828-4602',lineHeight:2
                    }
                  ]
                  } , //endcol
                  {},
                  {
                    width:150,
                  "nodeName": "DIV",
                  "stack": [
                    {lineHeight: 1,
                      
                      "text": "เลขที่ใบเสนอราคา:"+'\nQ'+'-'+brand.join('')+'E1'+'_'+customer_code+'_'+'64C'+'_'+cus_type+'_'+model.join('')+'\n'+'rev0'+'_'+MyDateString,
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-4",
                        "right"
                      ]
                    },
                    {lineHeight: 0.25,
                      "text": "วันที่:"+MyDateString2,
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-4",
                        "right",
                        "text-center"
                      ]
                    },
                    {lineHeight: 0.5,
                      "text": " Customer Ref. No.:" +cus_ref,
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      
                      
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-4",
                        "right"
                      ]
                    },

                    {
                      text: "Rev.0"+"                "+model2,background:"yellow",
                      "nodeName": "SPAN",
                      "style": [
                        "html-span",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center",
                        "col-4",
                        "right"
                      ]
                    },
                  
                  ]
                } 
                ]

                },
                 
            
                {
                  columns: [
                  { width: '*', text: '' },
                          {
                            style: 'tableExample',
                        color: '#555',
                        
                        table: {
                            body: [
                                [
                                    {
                                        text : 'เลขประจำตัวผู้เสียภาษี: 0-1055-62123-01-0'
                                        
                                    } ,
                                   
                                   
                                ],
                                
                              
                            ],alignment: "center"
                        },
                       
                        layout: {
                          
                            hLineColor: function(i, node) {
                                return (i === 0 || i === node.table.body.length) ? 'black' : 'black';
                            },
                            vLineColor: function(i, node) {
                                return (i === 0 || i === node.table.widths.length) ? 'black' : 'black';
                            },
                            paddingLeft: function(i, node) { return 5; },
                            paddingRight: function(i, node) { return 5; },
                            paddingTop: function(i, node) { return 10; },
                            paddingBottom: function(i, node) { return 10; },
                            
                        },
                          },
                          { width: '*', text: '' },
                        ]
                  
                },
                
                {
                  columns: [
                  { width: '*', text: '' },
                       {text:'ใบเสนอราคา',alignment: 'center',fontSize: 20, bold: true},
                       { width: '*', text: '' },
                  ]
                  
                },
                {

                  columns: [
                  { width: 40, text: '' },
                  {width:200,
			table: {
        widths: [200, '*', '*', '*', '*', 200],
				body: [
					['ชื่อลูกค้า:'+name,'','','','',{text:'Company Tax Code:'+tax,alignment: 'center'}],
					['ที่อยู่:'+address, '','','','',''],
          ['', '','','','',''],
          ['', '','','','',''],
          ['', '','','','',''],
          ['', '','','','',''],
          ['', '','','','',''],
         
         
          ['Tel:'+phone,'','','','',{text:'Fax:'+fax,alignment: 'center'}],
          ['ATTN:'+attn,'','','','',{text:'Email:'+email,alignment: 'center'}]

				] ,alignment: "center"
			},
                       
                       layout: {
                         
                           hLineColor: function(i, node) {
                               return (i === 0 || i === node.table.body.length) ? 'black' : 'white';
                           },
                           vLineColor: function(i, node) {
                               return (i === 0 || i === node.table.widths.length) ? 'black' : 'white';
                           },
                          
                       },
                      },
                      { width: 500, text: '' },
                      ]
                      },
                
               
               
                {
                  
                  "nodeName": "DIV",
                  "stack": [
                    {
                      "text": "ทางบริษัทขอเรียนนำเสนอราคาของสินค้าดังต่อไปนี้",
                      "nodeName": "P",
                      "margin": [
                        0,
                        7,
                        0,
                        10
                      ],
                      "style": [
                        "html-p",
                        "html-div",
                        "html-page",
                        "container",
                        "row",
                        "justify-content-center"
                      ]
                    }
                  ]
                },
                 {
                  style: 'tableExample',
                    table: {
                      widths: [25, 160,25,50 ,50, 80,80],
                      body: [
                        ['ลำดับที่', 'รายการ', 'P/N','หน่วย','จำนวน','ราคา/หน่วย','มูลค่า(THB)'],
                        [product_number.join(''), product_output.join('')+discount_text.join(''), '',unit,product_quantity,unit_price,result],      
                        [{text:'ยอดรวม',alignment:'right',colSpan:6},'','','','','',toCommas(net_final_price)] ,               
                        [{text:'มูลค่ารวมทั้งสิ้นตามตัวอักษร',colSpan:3},'', '',{text:'ภาษีมูลค่าเพิ่ม 7%',colSpan:3},'','',toCommas(vat)],
                        [{text:thaibath,colSpan:3},'', '',{text:'มูลค่ารวมทั้งสิ้น',colSpan:3},'','',toCommas(net_price)],
                        
                      ]
                    }
                 },
                 {
                  style: 'tableExample',
                    table: {
                      
                      body: [
                        [''],
                        [''],
                        [''],
                        [''],
                        [''],
                        [''],
                        [''],

                        
                      ]
                    },layout: 'noBorders'
                 },
                {
                   columns: [
                      {text:'ตรวจทานแล้วเห็นควรอนุมัติซื้อ'},
                      {text:'ตรวจทานแล้วเห็นควรอนุมัติสั่งซื้อ'},
                   ],alignment:'center'
                },
                {
                  style: 'tableExample',
                    table: {
                      
                      body: [
                        [''],
                        [''],
                        [''],
                        [''],
                        [''],
                        [''],
                        [''],
                        [''],
                        [''],

                        
                      ]
                    },layout: 'noBorders'
                 },
               
                {
                  columns: [
                      {text:'ผู้อนุมัติสั่งซื้อ________________ (     )'},
                      {text:'ผู้เสนอราคา________________ (มงคล ชัยยงศิลป์)'},
                   ],alignment:'center'
                }
              ]
            }
          ]
        }
      ]
    }
  ],
  defaultStyle:{
    font:'THSarabunNew'
   
  }
  
};
pdfMake.createPdf(dd).open()



cus_ref="" 
product_number=[]
counter=0
product_output=[]
product_quantity=["","","","","","","","",""];
 brand=["","",""]
       cus_type=[""]
       model=[]
}

function reassign(array, index, newValue) {
    array[index] = newValue;
    return array;
}
function toCommas(value) {
    return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}
function isInteger(n) {
    return n === +n && n === (n|0);
}
function isFloat(n) {
    return n === +n && n !== (n|0);
}



    </script>
   